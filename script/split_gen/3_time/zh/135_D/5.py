def main():
    S = input()
    #print(S)
    #print(S[0],S[1],S[2])
    #print(S[1])
    #print(len(S))
    #print(S.count("?"))
    #print(3**S.count("?"))
    #print(2**S.count("?"))
    #print(3**S.count("?")*2**S.count("?"))
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #print(3**S.count("?")*2**S.count("?")%1000000007)
    #
