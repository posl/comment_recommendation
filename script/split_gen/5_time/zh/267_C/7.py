def max_sum(n, m, a):
    if m == 1:
        return max(a)
    if m == 2:
        return max(a[0] + a[1], a[-1] + a[-2])
    if m == 3:
        return max(a[0] + a[1] + a[2], a[-1] + a[-2] + a[-3], a[0] + a[1] + a[-1], a[0] + a[-2] + a[-1], a[-1] + a[-2] + a[0])
    if m == 4:
        return max(a[0] + a[1] + a[2] + a[3], a[-1] + a[-2] + a[-3] + a[-4], a[0] + a[1] + a[-1] + a[-2], a[0] + a[-1] + a[-2] + a[-3], a[-1] + a[-2] + a[-3] + a[0], a[0] + a[1] + a[2] + a[-1], a[0] + a[1] + a[-2] + a[-1], a[0] + a[-1] + a[-2] + a[-3], a[-1] + a[-2] + a[-3] + a[0])
    if m == 5:
        return max(a[0] + a[1] + a[2] + a[3] + a[4], a[-1] + a[-2] + a[-3] + a[-4] + a[-5], a[0] + a[1] + a[-1] + a[-2] + a[-3], a[0] + a[-1] + a[-2] + a[-3] + a[-4], a[-1] + a[-2] + a[-3] + a[-4] + a[0], a[0] + a[1] + a[2] + a[3] + a[-1], a[0] + a[1] + a[2] + a[-2] + a[-1], a[0] + a[1] + a[-1
